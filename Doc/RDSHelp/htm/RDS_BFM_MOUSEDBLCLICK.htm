<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>А.2.6.8. RDS_BFM_MOUSEDBLCLICK &ndash; двойной щелчок мыши</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="app_index.htm">Приложения</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a">Приложение А. Функции, константы и структуры RDS</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a_2">А.2. События блока и связанные с ними описания</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a_2_6">А.2.6. События пользовательского интерфейса и рисования внешнего вида блоков</a></p>
<div class="level"><p>А.2.6.8. <span class="cpp">RDS_BFM_MOUSEDBLCLICK</span> &ndash; двойной щелчок мыши</p>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="RDS_BFM_MENUFUNCTION.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="RDS_BFM_MOUSEDOWN.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="app_index.htm#light_htm:RDS_BFM_MOUSEDBLCLICK">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Приложения</h1>
<h2 class="off">Приложение А. Функции, константы и структуры RDS</h2>
<h3 class="off">А.2. События блока и связанные с ними описания</h3>
<h4 class="off">А.2.6. События пользовательского интерфейса и рисования внешнего вида блоков</h4>
<h5>А.2.6.8. <span class="cpp">RDS_BFM_MOUSEDBLCLICK</span> &ndash; двойной щелчок мыши</h5>


<p class="apphdr">Поток, в котором вызывается <a href="app_a_2_1.htm" title="А.2.1. Функция модели блока">функция модели</a></p>
<p>Главный поток RDS.</p>

<p class="apphdr">Первый параметр функции модели (<span class="cpp">int&nbsp;CallMode</span>)</p>
<p>Константа <span class="cpp">RDS_BFM_MOUSEDBLCLICK</span>.</p>

<p class="apphdr">Третий параметр функции модели (<span class="cpp">void&nbsp;*ExtParam</span>)</p>
<p>Указатель на структуру описания события <span class="cpp"><a href="#ref2" title="Структура RDS_MOUSEDATA">RDS_MOUSEDATA</a></span>.</p>

<p class="apphdr">Возвращаемое функцией модели значение</p>
    <div class="tableshift"><div class="tcont">
    <table>
      <tr>
        <td><span class="cpp">RDS_BFR_DONE</span></td>
        <td>Двойной щелчок обработан блоком.</td>
      </tr>
      <tr>
        <td><span class="cpp"><span id="light_ref1">RDS_BFR_NOTPROCESSED</span></span></td>
        <td>Двойной щелчок не обработан блоком, он будет передан в
        <a href="um_1_2.htm#ref13" title="Родительская подсистема">родительскую подсистему</a>,
        а затем, если и она его не обработает, в RDS.</td>
      </tr>
    </table>
    </div></div>

<p class="apphdr">Примечания</p>
<p>Реакция на событие <span class="cpp">RDS_BFM_MOUSEDBLCLICK</span> вызывается при двойном щелчке на
изображении блока в окне подсистемы, если одновременно выполняются следующие условия:</p>
<ul>
  <li>RDS находится в режиме <a href="pm_1_3.htm#ref2" title="Режим моделирования">моделирования</a> или
  <a href="pm_1_3.htm#ref3" title="Режим расчета">расчета</a>;</li>
  <li>изображение блока находится на видимом <a href="um_2_12.htm" title="&sect;2.12.1. Использование слоев">слое</a>
  окна подсистемы, для которого разрешено редактирование;</li>
  <li>в <a href="pm_1_4.htm#pic3" title="Параметры блока &ndash; модель и реакции">параметрах блока</a> разрешена реакция на мышь.</li>
</ul>

<p class="noindent">Блоки могут обрабатывать щелчки кнопок мыши только в режимах моделирования и расчета: в
<a href="pm_1_3.htm#ref1" title="Режим редактирования">режиме редактирования</a> мышь используется для редактирования схемы. Если изображения
блоков перекрываются, двойной щелчок мыши сначала будет передан в блок, изображение которого находится ближе всего
к переднему плану. Если его модель не обработает двойной щелчок, будет вызвана модель блока, находящегося дальше,
и т.д. Если ни один блок не обработает двойной щелчок, будет вызвана модель подсистемы для реакции на событие
<span class="cpp"><a href="RDS_BFM_WINDOWMOUSEDBLCLICK.htm" title="А.2.6.16. RDS_BFM_WINDOWMOUSEDBLCLICK &ndash; реакция подсистемы на двойной щелчок мыши в своем окне">RDS_BFM_WINDOWMOUSEDBLCLICK</a></span>. Если же и подсистема не среагирует на двойной щелчок, он
будет обработан RDS (будет включен режим редактирования и, если щелчок пришелся на блок, будет открыто
окно его параметров или вызвана функция настройки). Реакция блоков на мышь подробно рассматривается в
<a href="pm_index.htm#light_htm:pm_2_12" title="&sect;2.12. Реакция блоков на действия пользователя">&sect;2.12 руководства программиста</a>. Следует помнить, что, в отличие от большинства других
событий, при реакции на мышь возврат стандартной константы <span class="cpp">RDS_BFR_DONE</span> сообщает
RDS о том, что блок <span class="emph">обработал</span> действие пользователя. Таким образом, если разрешить
в параметрах блока реакцию на мышь, блок начнет перехватывать все щелчки, пришедшиеся на его изображение, даже
если не включать в модель реакции на события <span class="cpp">RDS_BFM_MOUSE*</span>. Чтобы блок, которому
разрешена реакция на мышь, был &laquo;прозрачным&raquo; для щелчков, его модель должна вернуть константу
<span class="cpp">RDS_BFR_NOTPROCESSED</span> (пример использования этой константы приведен в
<a href="pm_2_12_3.htm" title="&sect;2.12.3. Реакция на мышь в блоках сложной формы">&sect;2.12.3 руководства программиста</a>).</p>

<p><span id="ref2">Для</span> <span id="ref3">описания</span>
произошедшего события служит структура <span class="cpp">RDS_MOUSEDATA</span> (она используется и в
других событиях реакции на мышь):</p>

<pre class="cpp">  <span class="kw">typedef</span> <span class="kw">struct</span> {
    <span class="kw">int</span> x,y;           <span class="rem">// Координаты курсора мыши</span>
    <span class="kw">int</span> BlockX,BlockY; <span class="rem">// Координаты точки привязки блока</span>
    <span class="kw">int</span> Left,Top;      <span class="rem">// Верхний левый угол изображения блока</span>
    <span class="kw">int</span> Width,Height;  <span class="rem">// Размеры изображения блока</span>
    <span class="kw">int</span> IntZoom;       <span class="rem">// Масштаб окна подсистемы в %</span>
    <a class="hidden" href="app_ids.htm#light_ref14" title="Беззнаковое целое 32 бита">DWORD</a> Button;      <span class="rem">// Кнопка мыши (RDS_M*)</span>
    <a class="hidden" href="app_ids.htm#light_ref14" title="Беззнаковое целое 32 бита">DWORD</a> Shift;       <span class="rem">// </span><a class="hidden" href="RDS_BFM_KEYDOWN.htm#light_ref4" title="Флаги мыши и клавиатуры"><span class="rem">Флаги мыши и клавиатуры</span></a><span class="rem"> (RDS_M*, RDS_K*)</span>
    <span class="kw">double</span> DoubleZoom; <span class="rem">// Масштабный к-т окна (в долях единицы)</span>
    <span class="kw">int</span> MouseEvent;    <span class="rem">// Событие</span>
    <span class="kw">int</span> Viewport;      <span class="rem">// Номер порта вывода или -1</span>
  } <span id="light_ref2">RDS_MOUSEDATA</span>;
  <span class="kw">typedef</span> RDS_MOUSEDATA *<span id="light_ref3">RDS_PMOUSEDATA</span>;</pre>

<p class="apphdr">Поля структуры</p>

<dl>
  <dt><span class="cpp">x</span>,&nbsp;<span class="cpp">y</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Координаты курсора мыши в окне подсистемы на момент возникновения события.</dd>

  <dt><span class="cpp">BlockX</span>,&nbsp;<span class="cpp">BlockY</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Координаты точки привязки изображения блока в текущем масштабе. Для блоков с
  <a href="um_1_2.htm#light_ref22">векторной картинкой</a> это
  положение начала координат этой картинки, для
  <a href="pm_2_10_1.htm" title="&sect;2.10.1. Рисование изображения блока в окне подсистемы">программно рисуемых</a>
  блоков и блоков, изображаемых прямоугольником с текстом, это координаты левого верхнего угла изображения
  (горизонтальная ось координат направлена вправо, вертикальная &ndash; вниз, начало координат
  &ndash; левый верхний угол рабочего поля). Если положение блока связано с его
  <a href="pm_1_5.htm" title="&sect;1.5. Статические переменные блоков, входы и выходы">переменными</a>, значения
  <span class="cpp">BlockX</span> и <span class="cpp">BlockY</span> в этой структуре указываются уже с учетом
  значений этих переменных. При реакции на события <span class="cpp">RDS_BFM_WINDOWMOUSE*</span> эти поля
  не используются.</dd>

  <dt><span class="cpp">Left</span>,&nbsp;<span class="cpp">Top</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Горизонтальная (<span class="cpp">Left</span>) и вертикальная (<span class="cpp">Top</span>) фактические
  координаты верхнего левого угла изображения блока в текущем масштабе на момент последней перерисовки
  окна подсистемы. При реакции на события <span class="cpp">RDS_BFM_WINDOWMOUSE*</span> эти поля не используются.</dd>

  <dt><span class="cpp">Width</span>,&nbsp;<span class="cpp">Height</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Фактические ширина (<span class="cpp">Width</span>) и высота (<span class="cpp">Height</span>) изображения
  блока в текущем масштабе на момент последней перерисовки окна подсистемы. При реакции на события
  <span class="cpp">RDS_BFM_WINDOWMOUSE*</span> эти поля не используются.</dd>

  <dt><span class="cpp">IntZoom</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Текущий масштаб окна подсистемы в процентах.</dd>

  <dt><span class="cpp">Button</span>&emsp;(<span class="cpp"><i>DWORD</i></span>)</dt>
    <dd>Кнопка мыши, нажатие или отпускание которой вызвало событие:
    <div class="tableleft"><div class="tcont">
      <table class="list">
        <tr>
          <td class="term"><span class="cpp"><span id="light_ref4">RDS_MLEFTBUTTON</span></span></td>
          <td>Левая кнопка мыши.</td>
        </tr>
        <tr>
          <td class="term"><span class="cpp"><span id="light_ref5">RDS_MRIGHTBUTTON</span></span></td>
          <td>Правая кнопка мыши.</td>
        </tr>
        <tr>
          <td class="term"><span class="cpp"><span id="light_ref6">RDS_MMIDDLEBUTTON</span></span></td>
          <td>Средняя кнопка мыши.</td>
        </tr>
      </table>
    </div></div>
    </dd>

  <dt><span class="cpp">Shift</span>&emsp;(<span class="cpp"><i>DWORD</i></span>)</dt>
  <dd><a href="RDS_BFM_KEYDOWN.htm#light_ref4" title="Флаги мыши и клавиатуры">Битовые флаги</a>, описывающие состояние специальных клавиш
  клавиатуры и кнопок мыши в момент возникновения события.</dd>

  <dt><span class="cpp">DoubleZoom</span>&emsp;(<span class="cpp"><i>double</i></span>)</dt>
  <dd>Текущий масштаб окна подсистемы в долях единицы: 1 для 100%, 2 для 200%, 0.5 для 50% и т.п.</dd>

  <dt><span class="cpp">MouseEvent</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Действие пользователя, которое привело к возникновению события. В реакциях на события
  <span class="cpp">RDS_BFM_MOUSE*</span> дублирует параметр <span class="cpp">CallMode</span>
  <a href="app_a_2_1.htm" title="А.2.1. Функция модели блока">функции модели</a>. В реакциях подсистем
  <span class="cpp">RDS_BFM_WINDOWMOUSE*</span> в это поле записывается идентификатор события, близкого
  по смыслу к произошедшему событию:
  <div class="tablecenter"><div class="tcont">
  <table>
    <tr>
      <th>Событие</th>
      <th><span class="cpp">CallMode</span></th>
      <th>Поле <span class="cpp">KeyEvent</span></th>
    </tr>
    <tr>
      <td>Нажатие кнопки мыши на изображении блока</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_MOUSEDOWN.htm" title="А.2.6.9. RDS_BFM_MOUSEDOWN &ndash; нажатие кнопки мыши">RDS_BFM_MOUSEDOWN</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEDOWN</span></td>
    </tr>
    <tr>
      <td>Отпускание кнопки мыши на изображении блока</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_MOUSEUP.htm" title="А.2.6.11. RDS_BFM_MOUSEUP &ndash; отпускание кнопки мыши">RDS_BFM_MOUSEUP</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEUP</span></td>
    </tr>
    <tr>
      <td>Перемещение курсора мыши над изображением блока</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_MOUSEMOVE.htm" title="А.2.6.10. RDS_BFM_MOUSEMOVE &ndash; перемещение курсора мыши">RDS_BFM_MOUSEMOVE</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEMOVE</span></td>
    </tr>
    <tr>
      <td>Двойной щелчок на изображении блока</td>
      <td class="center"><span class="cpp"><a href="#top">RDS_BFM_MOUSEDBLCLICK</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEDBLCLICK</span></td>
    </tr>
    <tr>
      <td>Нажатие кнопки мыши на свободном месте окна подсистемы</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_WINDOWMOUSEDOWN.htm" title="А.2.6.17. RDS_BFM_WINDOWMOUSEDOWN &ndash; реакция подсистемы на нажатие кнопки мыши в своем окне">RDS_BFM_WINDOWMOUSEDOWN</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEDOWN</span></td>
    </tr>
    <tr>
      <td>Отпускание кнопки мыши на свободном месте окна подсистемы</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_WINDOWMOUSEUP.htm" title="А.2.6.19. RDS_BFM_WINDOWMOUSEUP &ndash; реакция подсистемы на отпускание кнопки мыши в своем окне">RDS_BFM_WINDOWMOUSEUP</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEUP</span></td>
    </tr>
    <tr>
      <td>Перемещение курсора мыши в окне подсистемы</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_WINDOWMOUSEMOVE.htm" title="А.2.6.18. RDS_BFM_WINDOWMOUSEMOVE &ndash; реакция подсистемы на перемещение курсора мыши в своем окне">RDS_BFM_WINDOWMOUSEMOVE</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEMOVE</span></td>
    </tr>
    <tr>
      <td>Двойной щелчок на свободном месте окна подсистемы</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_WINDOWMOUSEDBLCLICK.htm" title="А.2.6.16. RDS_BFM_WINDOWMOUSEDBLCLICK &ndash; реакция подсистемы на двойной щелчок мыши в своем окне">RDS_BFM_WINDOWMOUSEDBLCLICK</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSEDBLCLICK</span></td>
    </tr>
    <tr>
      <td>Проверка возможности выбора блока щелчком мыши</td>
      <td class="center"><span class="cpp"><a href="RDS_BFM_MOUSESELECT.htm" title="А.2.7.3. RDS_BFM_MOUSESELECT &ndash; возможность выбора блока мышью">RDS_BFM_MOUSESELECT</a></span></td>
      <td class="center"><span class="cpp">RDS_BFM_MOUSESELECT</span></td>
    </tr>
  </table>
  </div></div>
  </dd>

  <dt><span class="cpp">Viewport</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Номер <a href="pm_3_6_1.htm" title="&sect;3.6.1. Общие принципы работы с портом вывода">порта вывода</a>, из которого пришла информация о событии
  (нажатии, отпускании кнопки, перемещении курсора и т.п.), или &minus;1, если событие произошло в
  обычном окне подсистемы.</dd>
</dl>

<p class="apphdr">См. также</p>
<p class="seealso"><span class="cpp"><a href="RDS_BFM_MOUSEDOWN.htm" title="А.2.6.9. RDS_BFM_MOUSEDOWN &ndash; нажатие кнопки мыши">RDS_BFM_MOUSEDOWN</a></span>,
<span class="cpp"><a href="RDS_BFM_MOUSEUP.htm" title="А.2.6.11. RDS_BFM_MOUSEUP &ndash; отпускание кнопки мыши">RDS_BFM_MOUSEUP</a></span>,
<span class="cpp"><a href="RDS_BFM_MOUSEMOVE.htm" title="А.2.6.10. RDS_BFM_MOUSEMOVE &ndash; перемещение курсора мыши">RDS_BFM_MOUSEMOVE</a></span>,
<span class="cpp"><a href="RDS_BFM_WINDOWMOUSEDOWN.htm" title="А.2.6.17. RDS_BFM_WINDOWMOUSEDOWN &ndash; реакция подсистемы на нажатие кнопки мыши в своем окне">RDS_BFM_WINDOWMOUSEDOWN</a></span>,
<span class="cpp"><a href="RDS_BFM_WINDOWMOUSEUP.htm" title="А.2.6.19. RDS_BFM_WINDOWMOUSEUP &ndash; реакция подсистемы на отпускание кнопки мыши в своем окне">RDS_BFM_WINDOWMOUSEUP</a></span>,
<span class="cpp"><a href="RDS_BFM_WINDOWMOUSEMOVE.htm" title="А.2.6.18. RDS_BFM_WINDOWMOUSEMOVE &ndash; реакция подсистемы на перемещение курсора мыши в своем окне">RDS_BFM_WINDOWMOUSEMOVE</a></span>,
<span class="cpp"><a href="RDS_BFM_WINDOWMOUSEDBLCLICK.htm" title="А.2.6.16. RDS_BFM_WINDOWMOUSEDBLCLICK &ndash; реакция подсистемы на двойной щелчок мыши в своем окне">RDS_BFM_WINDOWMOUSEDBLCLICK</a></span>.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="RDS_BFM_MENUFUNCTION.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="RDS_BFM_MOUSEDOWN.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="app_index.htm#light_htm:RDS_BFM_MOUSEDBLCLICK">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
