<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>&sect;3.8.11.3. Сообщение от управляющей программы</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="um_index.htm">Описание пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_3">Глава 3. Использование стандартных модулей автокомпиляции</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_3_8">&sect;3.8. Краткий перечень вводимых в модель описаний и реакций на события</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_3_8_11">&sect;3.8.11. Прочие реакции</a></p>
<div class="level"><p>&sect;3.8.11.3. Сообщение от управляющей программы</p>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="ac_RDS_BFM_SETUP.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="ac_RDS_BFM_TIMER.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:ac_RDS_BFM_REMOTEMSG">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Описание пользователя</h1>
<h2 class="off">Глава 3. Использование стандартных модулей автокомпиляции</h2>
<h3 class="off">&sect;3.8. Краткий перечень вводимых в модель описаний и реакций на события</h3>
<h4 class="off">&sect;3.8.11. Прочие реакции</h4>
<h5>&sect;3.8.11.3. Сообщение от управляющей программы</h5>


<p>Это событие возникает при управлении RDS
<a href="pm_index.htm#light_htm:pm_3" title="Глава 3. Управление RDS из других приложений">из внешнего приложения</a> в блоке, который программно вызван из
этого приложения при помощи одной из функций специальной библиотеки
&laquo;<span class="file">RdsCtrl.dll</span>&raquo;. Внешнее управление обычно используют для включения
RDS в состав более крупных специализированных программных комплексов, в которых пользователь не
взаимодействует с RDS и загруженной схемой непосредственно. Пользовательский интерфейс в таких
случаях обычно обеспечивается внешним приложением, которое в нужный момент передает блокам схемы какую-либо
информацию и получает от них ответ. Модуль автокомпиляции никак не автоматизирует создание блоков,
отвечающих на такие внешние вызовы. Он предоставляет разработчику возможность написать реакцию модели на
сообщение от внешней программы, но разбор переданных данных и отправку ответа разработчик должен выполнить в
этой реакции вручную.</p>

<p><span id="ref1">Текст</span> реакции на вызов от внешней программы вводится
на вкладке &laquo;<span class="menu"><a href="um_3_6_4.htm" title="&sect;3.6.4. Описания программы и реакции блока на события">события</a></span>&raquo; левой панели редактора модели:
раздел &laquo;<span class="menu">разное</span>&raquo;, подраздел &laquo;<span class="menu">сообщение от управляющей программы</span>&raquo;. В классе
блока для нее создается функция с именем <span class="cpp" id="light_ref1">rdsbcppRemoteMessage</span>
следующего вида:</p>

<pre class="cpp">  // Сообщение от управляющей программы
  void rdsbcppBlockClass::rdsbcppRemoteMessage(<a class="hidden" href="RDS_BFM_REMOTEMSG.htm#ref2" title="Указатель на RDS_REMOTEMSGDATA">RDS_PREMOTEMSGDATA</a> MessageData,int &Result)
  {
    <span class="changes"><i>&nbsp;&hellip; пользовательский текст реакции &hellip;&nbsp;</i></span>
  }</pre>

<p><span id="ref2">У</span>
функции два параметра. Параметр <span class="cpp">MessageData</span> &ndash; это указатель на структуру типа
<span id="light_ref2"><span class="cpp"><a href="RDS_BFM_REMOTEMSG.htm#ref1" title="Структура RDS_REMOTEMSGDATA">RDS_REMOTEMSGDATA</a></span></span>, содержащую полученные от внешнего
приложения данные и описание вызова:</p>

<pre class="cpp">  typedef struct {
    <a class="hidden" href="app_ids.htm#light_ref20" title="Указатель на строку (char*)">LPSTR</a> String;         // Переданная приложением строка
    int Value;            // Переданное приложением число
    <a class="hidden" href="app_ids.htm#light_ref20" title="Указатель на строку (char*)">LPSTR</a> ControllerName; // Имя приложения
  } <a class="hidden" href="RDS_BFM_REMOTEMSG.htm#ref1" title="Структура RDS_REMOTEMSGDATA">RDS_REMOTEMSGDATA</a>;
  typedef <a class="hidden" href="RDS_BFM_REMOTEMSG.htm#ref1" title="Структура RDS_REMOTEMSGDATA">RDS_REMOTEMSGDATA</a> *<a class="hidden" href="RDS_BFM_REMOTEMSG.htm#ref2" title="Указатель на RDS_REMOTEMSGDATA">RDS_PREMOTEMSGDATA</a>;</pre>

<p>Поля структуры имеют следующий смысл:</p>
<dl>
  <dt><span class="cpp">String</span>&emsp;(<span class="cpp"><i><a href="app_ids.htm#light_ref20" title="Указатель на строку (char*)">LPSTR</a></i></span>)</dt>
  <dd>Указатель на строку (<span class="cpp">char*</span>), переданную вызвавшим приложением (сама строка находится
  во внутренней памяти RDS и будет удалена после завершения этой реакции).</dd>

  <dt><span class="cpp">Value</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Целое число, переданное вызвавшим приложением.</dd>

  <dt><span class="cpp">ControllerName</span>&emsp;(<span class="cpp"><i>LPSTR</i></span>)</dt>
  <dd>Указатель на строку (<span class="cpp">char*</span>) с названием управляющего приложения, если это
  приложение сообщило RDS свое название.</dd>
</dl>

<p class="noindent">Второй параметр функции реакции &ndash; это ссылка на целую переменную
<span class="cpp">Result</span>, через которую модель блока может вернуть вызвавшему приложению целое число в
ответ на переданные им данные. Для возврата в вызвавшее приложение строки используется сервисная функция
<span class="cpp"><a href="rdsRemoteReply.htm" title="А.5.21.6. rdsRemoteReply &ndash; возврат строки управляющему приложению">rdsRemoteReply</a></span>.</p>

<p>При написании моделей блоков без использования модуля автокомпиляции вызову от внешнего приложения соответствует
константа RDS <span class="cpp"><a href="RDS_BFM_REMOTEMSG.htm" title="А.2.4.11. RDS_BFM_REMOTEMSG &ndash; вызов от внешнего приложения">RDS_BFM_REMOTEMSG</a></span>.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="ac_RDS_BFM_SETUP.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="ac_RDS_BFM_TIMER.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:ac_RDS_BFM_REMOTEMSG">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
