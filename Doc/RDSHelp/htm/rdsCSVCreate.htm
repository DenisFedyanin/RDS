<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>А.5.32.1. rdsCSVCreate &ndash; создать объект для работы с текстом в формате CSV</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="app_index.htm">Приложения</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a">Приложение А. Функции, константы и структуры RDS</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a_5">А.5. Сервисные функции RDS</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a_5_32">А.5.32. Вспомогательный объект для работы с форматом CSV</a></p>
<div class="level"><p>А.5.32.1. <span class="cpp">rdsCSVCreate</span> &ndash; создать объект для работы с текстом в формате CSV</p>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="RDS_PAN_WIDTH.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="rdsCSVGetItem.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="app_index.htm#light_htm:rdsCSVCreate">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Приложения</h1>
<h2 class="off">Приложение А. Функции, константы и структуры RDS</h2>
<h3 class="off">А.5. Сервисные функции RDS</h3>
<h4>А.5.32. Вспомогательный объект для работы с форматом CSV</h4>
<p class="abstract">Описываются функции и команды вспомогательного объекта RDS, предназначенного для создания и разбора текста в формате CSV, то есть набора текстовых значений, разделенных запятыми.</p>
<h5>А.5.32.1. <span class="cpp">rdsCSVCreate</span> &ndash; создать объект для работы с текстом в формате CSV</h5>


<p>Функция <span class="cpp">rdsCSVCreate</span> создает
<a href="app_a_objects.htm" title="А.5.22.1. Использование вспомогательных объектов RDS">вспомогательный объект</a> RDS,
с помощью которого можно работать с текстом формата CSV (comma separated values), то есть с текстом,
каждая строка которого содержит набор значений, отделенных друг от друга запятой или
другим символом-разделителем.</p>

<pre class="cpp">  <a class="hidden" href="app_ids.htm#light_ref6" title="Идентификатор вспомогательного объекта">RDS_HOBJECT</a> <a class="hidden" href="app_ids.htm#light_ref24" title="Тип вызова сервисных функций">RDSCALL</a> rdsCSVCreate(<span class="kw">void</span>);</pre>

<p class="apphdr">Тип указателя на эту функцию</p>
<p><span class="cpp">RDS_HoV</span></p>

<p class="apphdr">Возвращаемое значение</p>
<p>Уникальный идентификатор созданного объекта (<span class="cpp"><a href="app_ids.htm#light_ref6" title="Идентификатор вспомогательного объекта">RDS_HOBJECT</a></span>).</p>

<p class="apphdr">Примечания</p>
<p>Эта функция создает вспомогательный объект, с помощью которого можно как разбирать текст в формате CSV,
так и формировать его. Такие тексты удобны для простого хранения различных матриц и списков. Элементами текста,
с которыми работает объект, являются строки, поэтому если нужно работать с целыми или вещественными числами,
преобразовывать строки в числа и числа в строки нужно вручную. Элементы разделяются запятыми. Если элемент текста
содержит пробелы, он должен быть заключен в двойные кавычки, если элемент содержит двойные кавычки, символ двойной
кавычки в нем удваивается. Например, текст</p>

<pre class="cpp">  Строка1,"alpha, beta","строка""с""кавычкой", "Строка 2"
  10.0,    20.0,30.0
  1,,"2 3"</pre>

<p class="noindent">будет состоять из следующих элементов:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th></th>
    <th>Столбец 0</th>
    <th>Столбец 1</th>
    <th>Столбец 2</th>
    <th>Столбец 3</th>
  </tr>
  <tr>
    <th>Строка 0</th>
    <td>Строка1</td>
    <td>alpha, beta</td>
    <td>строка"с"кавычкой</td>
    <td>Строка 2</td>
  </tr>
  <tr>
    <th>Строка 1</th>
    <td>10.0</td>
    <td>20.0</td>
    <td>30.0</td>
    <td></td>
  </tr>
  <tr>
    <th>Строка 2</th>
    <td>1</td>
    <td></td>
    <td>2 3</td>
    <td></td>
  </tr>
</table>
</div></div>

<p>При желании, командой <span class="cpp"><a href="RDS_CSV_DELIMITERCHAR.htm" title="А.5.32.6. Команда RDS_CSV_DELIMITERCHAR &ndash; символ-разделитель">RDS_CSV_DELIMITERCHAR</a></span> вместо запятой можно установить другой
символ-разделитель, а командой <span class="cpp"><a href="RDS_CSV_QUOTECHAR.htm" title="А.5.32.16. Команда RDS_CSV_QUOTECHAR &ndash; символ-ограничитель строки">RDS_CSV_QUOTECHAR</a></span> заменить на другой символ
двойную кавычку, используемую для выделения строк с пробелами.</p>

<p>При разборе текста можно загрузить в объект весь текст из какого-либо файла
(команда <span class="cpp"><a href="RDS_CSV_LOADFROMFILE.htm" title="А.5.32.12. Команда RDS_CSV_LOADFROMFILE &ndash; загрузить текст из файла">RDS_CSV_LOADFROMFILE</a></span>), считывать его из файла построчно (команда
<span class="cpp"><a href="RDS_CSV_STRFROMFILE.htm" title="А.5.32.18. Команда RDS_CSV_STRFROMFILE &ndash; считать строку из файла">RDS_CSV_STRFROMFILE</a></span>) или передать в объект уже загруженный в память текст
(команда <span class="cpp"><a href="RDS_CSV_TEXT.htm" title="А.5.32.20. Команда RDS_CSV_TEXT &ndash; весь текст объекта">RDS_CSV_TEXT</a></span>). При этом функцией <span class="cpp"><a href="rdsCSVGetItem.htm" title="А.5.32.2. rdsCSVGetItem &ndash; получить элемент текста">rdsCSVGetItem</a></span> можно
получить элемент текста, находящийся в заданной строке и заданном столбце. При формировании текста можно
записывать элементы в заданную строку и столбец текста функцией <span class="cpp"><a href="rdsCSVSetItem.htm" title="А.5.32.3. rdsCSVSetItem &ndash; установить элемент текста">rdsCSVSetItem</a></span>, а
уже сформированный текст записывать в файл целиком (команда <span class="cpp"><a href="RDS_CSV_SAVETOFILE.htm" title="А.5.32.17. Команда RDS_CSV_SAVETOFILE &ndash; записать текст в файл">RDS_CSV_SAVETOFILE</a></span>) или
построчно (команда <span class="cpp"><a href="RDS_CSV_STRTOFILE.htm" title="А.5.32.19. Команда RDS_CSV_STRTOFILE &ndash; записать строку в файл">RDS_CSV_STRTOFILE</a></span>), а также получать его динамически сформированную
копию (команда <span class="cpp">RDS_CSV_TEXT</span>).</p>

<p>Созданный вспомогательный объект будет существовать до тех пор, пока схема не будет выгружена из памяти,
или пока он не будет удален вызовом функции <span class="cpp"><a href="rdsDeleteObject.htm" title="А.5.22.4. rdsDeleteObject &ndash; удалить объект">rdsDeleteObject</a></span>.</p>


<p class="apphdr">Пример</p>
<p>Пример использования функции <span class="cpp">rdsCSVCreate</span> приведен в
<a href="pm_2_16_2.htm" title="&sect;2.16.2. Добавление и удаление блоков и связей">&sect;2.16.2 руководства программиста</a>.</p>

<p class="apphdr">См. также</p>
<p class="seealso"><a href="app_a_objects.htm" title="А.5.22.1. Использование вспомогательных объектов RDS">Вспомогательные объекты</a>,
<span class="cpp"><a href="rdsDeleteObject.htm" title="А.5.22.4. rdsDeleteObject &ndash; удалить объект">rdsDeleteObject</a></span>.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="RDS_PAN_WIDTH.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="rdsCSVGetItem.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="app_index.htm#light_htm:rdsCSVCreate">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
