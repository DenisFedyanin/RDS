<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>А.5.20.4. rdsNetSendData &ndash; передача данных конкретному блоку канала</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="app_index.htm">Приложения</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a">Приложение А. Функции, константы и структуры RDS</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a_5">А.5. Сервисные функции RDS</a></p>
<div class="level"><p><a href="app_index.htm#light_htm:app_a_5_20">А.5.20. Сетевые функции</a></p>
<div class="level"><p>А.5.20.4. <span class="cpp">rdsNetSendData</span> &ndash; передача данных конкретному блоку канала</p>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="rdsNetConnect.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="rdsNetServer.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="app_index.htm#light_htm:rdsNetSendData">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Приложения</h1>
<h2 class="off">Приложение А. Функции, константы и структуры RDS</h2>
<h3 class="off">А.5. Сервисные функции RDS</h3>
<h4 class="off">А.5.20. Сетевые функции</h4>
<h5>А.5.20.4. <span class="cpp">rdsNetSendData</span> &ndash; передача данных конкретному блоку канала</h5>


<p><span id="ref1">Функция</span>
<span class="cpp"><span id="ref2">rdsNetSendData</span></span>
передает указанные данные конкретному блоку,
установившему соединение с указанным каналом сервера.</p>

<pre class="cpp">  <a class="hidden" href="app_ids.htm#light_ref11" title="Логический тип Windows API">BOOL</a> <a class="hidden" href="app_ids.htm#light_ref24" title="Тип вызова сервисных функций">RDSCALL</a> rdsNetSendData(
    <span class="kw">int</span> ConnId,              <span class="rem">// Идентификатор соединения</span>
    <a class="hidden" href="app_ids.htm#light_ref14" title="Беззнаковое целое 32 бита">DWORD</a> Flags,             <span class="rem">// Флаги (RDS_NETSEND_*)</span>
    <span class="kw">int</span> Id,                  <span class="rem">// Передаваемое целое (идентификатор)</span>
    <a class="hidden" href="app_ids.htm#light_ref20" title="Указатель на строку (char*)">LPSTR</a> String,            <span class="rem">// Передаваемая строка</span>
    <a class="hidden" href="app_ids.htm#light_ref21" title="Указатель на любые данные (void*)">LPVOID</a> Buf,              <span class="rem">// Передаваемая область памяти</span>
    <a class="hidden" href="app_ids.htm#light_ref14" title="Беззнаковое целое 32 бита">DWORD</a> BufSize,           <span class="rem">// Размер передаваемой области</span>
    <span id="light_ref1"><a class="hidden" href="app_ids.htm#light_ref7" title="Идентификатор машины в сети">RDS_NETSTATION</a></span> Station,  <span class="rem">// Сетевой идентификатор машины</span>
    <span id="light_ref2"><a class="hidden" href="app_ids.htm#light_ref8" title="Идентификатор блока в сети">RDS_NETBLOCK</a></span> Block       <span class="rem">// Сетевой идентификатор блока</span>
  );</pre>

<p class="apphdr">Тип указателя на эту функцию</p>
<p><span class="cpp">RDS_BIDwISpVDwNsNb</span></p>

<p class="apphdr">Параметры</p>

<dl>
  <dt><span class="cpp">ConnId</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Уникальный идентификатор сетевого соединения, через которое будут переданы данные.</dd>

  <dt><span class="cpp">Flags</span>&emsp;(<span class="cpp"><i><a href="app_ids.htm#light_ref14" title="Беззнаковое целое 32 бита">DWORD</a></i></span>)</dt>
  <dd>Набор <a href="rdsNetBroadcastData.htm#ref1" title="Флаги передачи данных по сети">битовых флагов</a>, управляющих передачей
  (те же, что и у функции <span class="cpp"><a href="rdsNetBroadcastData.htm" title="А.5.20.1. rdsNetBroadcastData &ndash; передача данных всем блокам канала">rdsNetBroadcastData</a></span>).</dd>

  <dt><span class="cpp">Id</span>&emsp;(<span class="cpp"><i>int</i></span>)</dt>
  <dd>Передаваемое в канал целое число. При установленном в параметре <span class="cpp">Flags</span> флаге
  <span class="cpp"><a href="rdsNetBroadcastData.htm#light_ref6" title="RDS_NETSEND_UPDATE">RDS_NETSEND_UPDATE</a></span> играет роль идентификатора передаваемых данных: устаревшие данные
  будут выброшены из очереди только в том случае, если их значение <span class="cpp">Id</span> совпадает с
  <span class="cpp">Id</span> в данном вызове.</dd>

  <dt><span class="cpp">String</span>&emsp;(<span class="cpp"><i><a href="app_ids.htm#light_ref20" title="Указатель на строку (char*)">LPSTR</a></i></span>)</dt>
  <dd>Указатель на передаваемую в канал строку. Если строку передавать не нужно, этот параметр
  может быть равен <span class="cpp">NULL</span>.</dd>

  <dt><span class="cpp">Buf</span>&emsp;(<span class="cpp"><i><a href="app_ids.htm#light_ref21" title="Указатель на любые данные (void*)">LPVOID</a></i></span>)</dt>
  <dd>Указатель на начало передаваемой в канал области памяти с двоичными данными.
  Если двоичные данные передавать не нужно, этот параметр может быть равен <span class="cpp">NULL</span>.</dd>

  <dt><span class="cpp">BufSize</span>&emsp;(<span class="cpp"><i>DWORD</i></span>)</dt>
  <dd>Размер в байтах передаваемой области памяти по указателю <span class="cpp">Buf</span>. При
  <span class="cpp">Buf==NULL</span> значение этого параметра игнорируется.</dd>

  <dt><span class="cpp">Station</span>&emsp;(<span class="cpp"><i><a href="app_ids.htm#light_ref7" title="Идентификатор машины в сети">RDS_NETSTATION</a></i></span>)</dt>
  <dd>Уникальный сетевой идентификатор (<span class="cpp">RDS_NETSTATION</span>) машины, на которой
  запущена копия RDS, в которую загружена схема, блоку которой отправляются данные.</dd>

  <dt><span class="cpp">Block</span>&emsp;(<span class="cpp"><i><a href="app_ids.htm#light_ref8" title="Идентификатор блока в сети">RDS_NETBLOCK</a></i></span>)</dt>
  <dd>Уникальный сетевой идентификатор (<span class="cpp">RDS_NETBLOCK</span>) блока, которому
  отправляются данные. Этот идентификатор никак не связан с внутренним идентификатором этого блока
  <span class="cpp"><a href="app_ids.htm#light_ref1" title="Идентификатор блока">RDS_BHANDLE</a></span>.</dd>
</dl>

<p class="apphdr">Возвращаемое значение</p>
<p><span class="cpp">TRUE</span> &ndash; данные успешно поставлены в очередь на передачу,
<span class="cpp">FALSE</span> &ndash; ошибка (например, нет соединения с идентификатором
<span class="cpp">ConnId</span>).</p>

<p class="apphdr">Примечания</p>
<p>Эта функция используется для передачи целого числа <span class="cpp">Id</span>, строки <span class="cpp">String</span>
и набора двоичных данных <span class="cpp">Buf</span> конкретному блоку, подключившемуся к какому-либо
каналу передачи данных сервера (принципы обмена данных по сети и каналы передачи данных подробно
рассматриваются в <a href="pm_2_15_1.htm" title="&sect;2.15.1. Общие принципы обмена данными по сети в RDS">&sect;2.15.1 руководства программиста</a>). В параметре
<span class="cpp">ConnId</span> передается идентификатор сетевого соединения с конкретным
каналом конкретного сервера, полученный с помощью функций
<span class="cpp"><a href="rdsNetConnect.htm" title="А.5.20.3. rdsNetConnect &ndash; установка сетевого соединения">rdsNetConnect</a></span> или
<span class="cpp"><a href="rdsNetServer.htm" title="А.5.20.5. rdsNetServer &ndash; запуск сервера и установка соединения с ним">rdsNetServer</a></span>. Строку и двоичные данные передавать не обязательно &ndash;
если они не нужны, соответствующим параметрам можно присвоить <span class="cpp">NULL</span>.</p>

<p>Блок-получатель однозначно определяется парой параметров <span class="cpp">Station</span> и
<span class="cpp">Block</span>: в первом передается идентификатор машины-получателя данных, во
втором &ndash; идентификатор блока на этой машине. Эти специальные сетевые идентификаторы модель
блока может узнать только из структуры <span class="cpp"><a href="RDS_BFM_NETDATARECEIVED.htm#ref1" title="Структура RDS_NETRECEIVEDDATA">RDS_NETRECEIVEDDATA</a></span>, получив данные от
этого блока. Таким образом, чтобы отправить данные какому-либо конкретному блоку, нужно сначала
получить от него какие-либо данные. Функция <span class="cpp">rdsNetSendData</span> в
RDS предназначена для ответа на переданные данные: если какой-либо блок передает данные в
канал функцией <span class="cpp"><a href="rdsNetBroadcastData.htm" title="А.5.20.1. rdsNetBroadcastData &ndash; передача данных всем блокам канала">rdsNetBroadcastData</a></span>, любой из принявших эти данные блоков может
послать ответ непосредственно отправителю. Если логика работы схемы требует передачи данных какому-либо
конкретному блоку на конкретной машине, для этого блока следует создать отдельный канал, в котором
он будет единственным получателем. Число каналов передачи данных на сервере не ограничено.</p>

<p>В результате вызова <span class="cpp">rdsNetSendData</span> данные, указанные в параметрах
функции, ставятся в очередь для отправки на сервер. Сервер, получив эти данные, отправляет их
на машину <span class="cpp">Station</span>. После получения данных на этой машине модель блока
<span class="cpp">Block</span> будет вызвана для реакции на событие
<span class="cpp"><a href="RDS_BFM_NETDATARECEIVED.htm" title="А.2.8.3. RDS_BFM_NETDATARECEIVED &ndash; получение данных блоком">RDS_BFM_NETDATARECEIVED</a></span>.</p>

<p class="apphdr">См. также</p>
<p class="seealso"><span class="cpp"><a href="rdsNetConnect.htm" title="А.5.20.3. rdsNetConnect &ndash; установка сетевого соединения">rdsNetConnect</a></span>,
<span class="cpp"><a href="rdsNetServer.htm" title="А.5.20.5. rdsNetServer &ndash; запуск сервера и установка соединения с ним">rdsNetServer</a></span>,
<span class="cpp"><a href="rdsNetBroadcastData.htm" title="А.5.20.1. rdsNetBroadcastData &ndash; передача данных всем блокам канала">rdsNetBroadcastData</a></span>,
<span class="cpp"><a href="RDS_BFM_NETDATARECEIVED.htm" title="А.2.8.3. RDS_BFM_NETDATARECEIVED &ndash; получение данных блоком">RDS_BFM_NETDATARECEIVED</a></span>,
<span class="cpp"><a href="RDS_BFM_NETDATAACCEPTED.htm" title="А.2.8.2. RDS_BFM_NETDATAACCEPTED &ndash; получение данных сервером">RDS_BFM_NETDATAACCEPTED</a></span>.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="rdsNetConnect.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="rdsNetServer.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="app_index.htm#light_htm:rdsNetSendData">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
