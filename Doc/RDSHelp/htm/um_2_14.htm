<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>&sect;2.14. Создание и изменение структур</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="um_index.htm">Описание пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2">Глава 2. Интерфейс пользователя</a></p>
<div class="level"><p>&sect;2.14. Создание и изменение структур</p>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="um_2_13.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="um_2_15_1.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_14">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Описание пользователя</h1>
<h2 class="off">Глава 2. Интерфейс пользователя</h2>
<h3>&sect;2.14. Создание и изменение структур</h3>
<p class="abstract">Описывается создание структур &ndash; сложных типов переменных, состоящих из произвольного набора полей. Структуры позволяют объединять разнородные данные в одной переменной.</p>


<p>Структура в RDS &ndash; это специальный тип переменной, состоящий из
произвольного количества полей, каждое из которых имеет собственное имя и тип.
Чаще всего структуры используются для работы с какими-либо сложными данными:
комплексными числами, векторами, кватернионами и т.п. Использовать структуры в
таких случаях предпочтительнее, чем, например, матрицы. Во-первых, структура, в
отличие от матрицы, всегда имеет постоянный размер в памяти, поэтому RDS
работает с ней быстрее. Во-вторых, поля структуры, в отличие от элементов матрицы,
имеют собственные имена, и пользователю легче запомнить, что вещественная часть
комплексной переменной &ndash; это &laquo;<span class="rdsvar">a.Im</span>&raquo;, а не &laquo;<span class="rdsvar">a[0]</span>&raquo;.
В-третьих, в структуре могут присутствовать поля различных типов, а все элементы
матрицы или массива всегда имеют один и тот же тип.</p>

<p>Типы полей структуры могут быть любыми, кроме массивов (вместо них следует
использовать матрицы), произвольных типов и тех структур, в которые в качестве
поля входит данная структура (в этом случае структура включала бы сама себя).
Каждая структура имеет уникальное <span class="term">имя типа</span>,
по которому к ней обращается пользователь. Для блоков RDS имя типа структуры и
имена ее полей обычно не имеют значения, они опознают структуру исключительно по
типам ее полей. С точки зрения
<a href="um_1_2.htm#ref3" title="Модель блока">модели блока</a>, все структуры, имеющие, например,
два поля, первое из которых имеет тип double, а второе &ndash; int, будут
эквивалентны, как бы ни назывались типы этих структур и их поля.</p>

<div class="picright"><div class="container" id="pic1">
<img src="../img/StructList.png" width="312" height="273" alt="Окно списка структур" />
<p id="light_pic1">Рис.&nbsp;227. Окно списка структур</p>
</div></div>


<p><span id="ref1">Структура</span>
может быть в любой момент создана или отредактирована пользователем при
помощи пункта <a href="um_2_1.htm" title="&sect;2.1. Главное окно и главное меню">главного меню RDS</a>
&laquo;<span class="menu">система | структуры</span>&raquo;. При этом следует иметь в виду, что,
<span id="light_ref1">если эта структура уже используется в каких-либо блоках схемы,
или в качестве типа поля в других структурах,
схема может перестать работать</span>: связи, подключенные к
<a href="um_2_7_3.htm" title="&sect;2.7.3. Подключение связей к полям структур и элементам массивов">отдельным полям структур</a>, отключатся при
переименовании этих полей; модели, ожидающие конкретного порядка и состава полей
структуры, откажутся работать при изменении порядка или типов ее полей, и т.п. По
этой причине к редактированию полей уже использующихся в схеме структур следует
подходить с осторожностью, и RDS предупреждает пользователя при попытке
сделать это.</p>

<p>При выборе в главном меню RDS пункта &laquo;<span class="menu">система | структуры</span>&raquo;
открывается окно со списком уже имеющихся в схеме структур
(<a href="#pic1" title="Окно списка структур">рис.&nbsp;227</a>).
<span id="ref2">Если</span> схема не загружена, в этом окне будет
показан набор структур по умолчанию, хранящийся в файле
&laquo;<span class="file"><span id="light_ref2">types.dat</span></span>&raquo; в
<a href="um_2_18.htm#ref2" title="Папка настроек">папке настроек RDS</a> &ndash; этот набор автоматически
добавляется к каждой создаваемой схеме. Список состоит из двух колонок: в колонке
&laquo;<span class="menu">тип</span>&raquo; отображается имя типа структуры, в колонке &laquo;<span class="menu">в блоках</span>&raquo;
&ndash; общее число блоков загруженной схемы, в которых эта структура уже используется.
Если в колонке &laquo;<span class="menu">в блоках</span>&raquo; выводится какое-либо число, неаккуратное
редактирование этой структуры может привести к неработоспособности схемы.</p>

<p>В нижней части окна находятся кнопки &laquo;<span class="menu">сохранить</span>&raquo;, записывающая
текущий список структур в файл &laquo;<span class="file">types.dat</span>&raquo; в качестве набора по
умолчанию, и &laquo;<span class="menu">OK</span>&raquo;, закрывающая окно. Справа от списка располагаются
кнопки для добавления, удаления, редактирования и изменения порядка структур:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th>Кнопка</th>
    <th>Действие</th>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_ArrowUp.png" width="25" height="25" alt="Кнопка: вверх" /></td>
    <td>Переместить выбранную структуру на одну позицию вверх по списку.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_ArrowDown.png" width="25" height="25" alt="Кнопка: вниз" /></td>
    <td>Переместить выбранную структуру на одну позицию вниз по списку.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Brackets.png" width="25" height="25" alt="Кнопка: {...}" /></td>
    <td>Редактировать выбранную структуру (вместо нажатия этой кнопки можно
    сделать двойной щелчок на имени структуры в списке).</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Plus.png" width="25" height="25" alt="Кнопка: плюс" /></td>
    <td>Добавить новую структуру.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Delete.png" width="25" height="25" alt="Кнопка: удалить" /></td>
    <td>Удалить выбранную структуру.</td>
  </tr>
</table>
</div></div>

<p>Порядок структур в списке влияет только на порядок их отображения в выпадающих
списках при задании типов переменных &ndash; обычно часто используемые структуры
размещают в начале списка. Этот порядок не влияет на работу схемы и может быть
свободно изменен.</p>

<p><span id="ref3">При</span>
нажатии кнопки редактирования структуры или при двойном щелчке на ее имени
открывается <span id="light_ref3">окно для ввода имени ее типа и
состава ее полей</span>
(<a href="#pic2" title="Окно редактирования структуры">рис.&nbsp;228</a>).
Если изменяемая структура используется в блоках схемы или в качестве типа
поля в какой-либо другой структуре, перед открытием окна будет выведено
предупреждение о возможных проблемах из-за редактирования этой структуры,
при этом пользователь может отказаться от редактирования или продолжить его,
несмотря на ожидаемые последствия.</p>

<div class="pic"><div class="container" id="pic2">
<img src="../img/StructEdit.png" width="600" height="336" alt="Окно редактирования структуры" />
<p id="light_pic2">Рис.&nbsp;228. Окно редактирования структуры</p>
</div></div>


<p>В верхней части окна редактирования структуры находится поле для ввода имени ее
типа. Имя типа структуры может содержать только буквы латинского алфавита, цифры и знак
подчеркивания, и при этом оно не должно начинаться с цифры (эти же требования
предъявляются к именам, например, в синтаксисе языка C). Имя типа должно быть
уникальным, нельзя дать структуре имя типа, уже данное другой структуре. Имена
типов, как и имена переменных в RDS, чувствительны к регистру:
&laquo;<span class="rdsvar">Complex</span>&raquo;, &laquo;<span class="rdsvar">complex</span>&raquo; и &laquo;<span class="rdsvar">COMPLEX</span>&raquo;
будут считаться разными типами.</p>

<p>Основную площадь окна занимает список полей структуры, фактически представляющий собой
сокращенный вариант списка, используемого для
<a href="um_2_9_2.htm" title="&sect;2.9.2. Редактирование списка переменных блока">задания переменных блока</a>. Список содержит
следующие колонки:</p>

<ul>
  <li>&laquo;<span class="menu">Начало</span>&raquo; &ndash; отображает смещение переменной в байтах от
  начала области памяти, которую занимает структура. Это число используется
  программистами при обращении к полям структуры из функции модели. Пользователь
  может не обращать внимания на эту колонку, тем более, что в ней нельзя ничего
  изменить, смещение вычисляется автоматически.</li>

  <li>&laquo;<span class="menu">Имя</span>&raquo; &ndash; имя поля структуры. Имена полей, как и имена
  переменных в RDS, должны удовлетворять тем же требованиям, что и
  идентификаторы в языке C: имя должно содержать только буквы латинского алфавита,
  цифры и знак подчеркивания, и при этом оно не должно начинаться с цифры. Имена
  чувствительны к регистру и должны быть уникальными в данной структуре. При желании,
  после имени поля можно ввести произвольный комментарий, отделив его от имени
  пробелом &ndash; этот комментарий будет отображаться в
  <a href="um_2_7_3.htm#pic1" title="Соединение поля выхода с другим блоком">меню подключения связи</a> к этому
  полю структуры.</li>

  <li>&laquo;<span class="menu">Тип</span>&raquo; &ndash; тип поля структуры. Тип выбирается из выпадающего
  списка, в котором содержатся все
  <a href="um_1_4.htm#ref1" title="Типы переменных блока">стандартные типы</a> переменных RDS, кроме массивов
  и произвольных типов, а также все имена структур, внутрь которых не входит
  редактируемая структура. Вместо массивов в структурах следует использовать
  матрицы, являющиеся, по сути, теми же массивами, но с двумя индексами.
  Произвольные типы, то есть переменные, фактический тип которым присваивается только
  программно или при срабатывании подключенных к ним связей, могут быть только
  переменными блока, и их использование в качестве полей структуры не разрешается.
  Другие структуры, в которые данная структура входит в качестве поля, тоже не могут быть
  использованы как тип ее поля, в противном случае нарушилась бы логика вложенности
  типов. Допустим, есть структуры &laquo;<span class="rdsvar">A</span>&raquo; и &laquo;<span class="rdsvar">B</span>&raquo;, причем в
  структуре &laquo;<span class="rdsvar">A</span>&raquo; одно из полей имеет тип &laquo;<span class="rdsvar">B</span>&raquo;.
  Включение в структуру &laquo;<span class="rdsvar">B</span>&raquo; поля типа &laquo;<span class="rdsvar">A</span>&raquo; привело бы к
  тому, что структура &laquo;<span class="rdsvar">A</span>&raquo; содержала бы сама себя в качестве составной
  части поля типа &laquo;<span class="rdsvar">B</span>&raquo;. RDS не даст выбрать неразрешенный тип
  в качестве типа поля структуры.</li>

  <li>Колонка с изображением размерной стрелки &ndash; размер поля структуры в памяти.
  Значение в этой колонке выводится для справки и не может быть изменено, оно иногда
  используется программистами моделей блоков и не представляет для пользователя
  интереса.</li>

  <li>&laquo;<span class="menu">По умолчанию</span>&raquo; &ndash; значение поля структуры по умолчанию в
  <a href="um_1_4.htm#ref22" title="Значение переменной по умолчанию">стандартном синтаксисе RDS</a>. Это значение
  присваивается полю структуры при ее создании или при
  <a href="um_1_3.htm#ref9" title="Сброс расчета">сбросе расчета</a>.</li>
</ul>

<p><span id="ref4">Непосредственно</span>
под списком полей отображается общее их число и
<span id="light_ref4"><span class="term">строка типа</span></span> &ndash;
специальная строка, в которой каждому полю соответствует один или несколько символов.
Эта строка используется программистами при написании моделей блоков
(см. <a href="pm_2_5_1.htm" title="&sect;2.5.1. Доступ к статическим переменным и работа в режиме расчета">&sect;2.5.1 руководства программиста</a>). Справа от списка находятся
кнопки, аналогичные кнопкам редактирования переменных блока, описанным в
<a href="um_2_9_2.htm" title="&sect;2.9.2. Редактирование списка переменных блока">&sect;2.9.2</a>:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th>Кнопка</th>
    <th>Действие</th>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_ArrowUp.png" width="25" height="25" alt="Кнопка: вверх" /></td>
    <td>Переместить выбранное поле на одну позицию вверх по списку.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_ArrowDown.png" width="25" height="25" alt="Кнопка: вниз" /></td>
    <td>Переместить выбранное поле на одну позицию вниз по списку.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Plus.png" width="25" height="25" alt="Кнопка: плюс" /></td>
    <td>Добавить поле перед выбранным (в списке появляется пустая строка, щелкнув на
    которой можно ввести имя поля). Добавить поле в конец списка всегда можно,
    щелкнув на пустой строке после последнего поля, специальной кнопки для этого
    не предусмотрено.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Delete.png" width="25" height="25" alt="Кнопка: удалить" /></td>
    <td>Удалить выбранное поле.</td>
  </tr>
</table>
</div></div>

<p>Следует помнить, что порядок полей в структуре важен для моделей блоков, и,
если его изменить, модели могут отказаться работать.</p>

<p>Кнопка &laquo;<span class="menu">OK</span>&raquo; внизу окна запоминает внесенные изменения в списке структур
схемы, кнопка &laquo;<span class="menu">отмена</span>&raquo; закрывает окно без изменений. После закрытия окна
редактирования структуры на экране снова появляется окно списка структур, изображенное
на <a href="#pic1" title="Окно списка структур">рис.&nbsp;227</a>.
Если в <a href="um_2_18.htm" title="&sect;2.18. Настройки RDS">настройках RDS</a> разрешена отмена
действий пользователя, после закрытия окна списка структур все внесенные изменения
можно отменить, либо нажав
<span class="keys">Ctrl</span>&nbsp;+&nbsp;<span class="keys">Z</span>, либо выбрав в главном меню RDS пункт
&laquo;<span class="menu">система | отмена</span>&raquo;
(см. <a href="um_2_1.htm" title="&sect;2.1. Главное окно и главное меню">&sect;2.1</a>).</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="um_2_13.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="um_2_15_1.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_14">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
