<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>&sect;2.16.2. Добавление блоков в библиотеку</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="um_index.htm">Описание пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2">Глава 2. Интерфейс пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2_16">&sect;2.16. Создание и редактирование библиотек и вкладок панели блоков</a></p>
<div class="level"><p>&sect;2.16.2. Добавление блоков в библиотеку</p>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="um_2_16_1.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="um_2_16_3.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_16_2">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Описание пользователя</h1>
<h2 class="off">Глава 2. Интерфейс пользователя</h2>
<h3 class="off">&sect;2.16. Создание и редактирование библиотек и вкладок панели блоков</h3>
<h4>&sect;2.16.2. Добавление блоков в библиотеку</h4>
<p class="abstract">Описывается создание новых библиотек и вкладок панели блоков и добавление в библиотеки блоков из загруженной схемы.</p>


<p>Окно библиотеки не позволяет каким-либо образом редактировать
<a href="um_2_9_1.htm#ref2" title="окно параметров простого блока">внутренние параметры</a>
блоков или вызывать их
<a href="um_2_6.htm#ref3" title="Настройка блока">функцию настройки</a>, поэтому, как правило,
перед добавлением блока в библиотеку этот блок сначала редактируется в
какой-нибудь схеме (возможно, временной, созданной специально для него): задаются
его параметры, размеры и т.п. После этого открывается окно библиотеки, в нем
выбирается нужная папка, и блок помещается в нее либо перетаскиванием правой кнопкой
мыши, либо через буфер обмена.</p>

<p>В отличие от панели блоков, библиотека блоков в RDS исходно пуста. Обычно
в нее добавляют редко используемые экспериментальные или созданные пользователем
блоки. Чтобы не сваливать все эти блоки в одну кучу, внутри библиотеки блоков,
как правило, создают вложенные папки
(&laquo;<span class="term">библиотеки</span>&raquo; в терминах RDS),
объединяющие блоки одинакового назначения или предназначенные для какой-либо
конкретной задачи. Вложенность папок библиотек может быть любой (в отличие от
панели блоков, в которой допускается только один уровень вложенности: папки-вкладки
и блоки в них). Поскольку каждая папка библиотеки физически является папкой
файловой системы, их имена должны удовлетворять требованиям к именам файлов
Windows, то есть не должны содержать символов, запрещенных для имен файлов
(прямая и обратная косая черта, двоеточие, вопросительный знак, звездочка, знак
кавычки, знаки &laquo;больше&raquo; и &laquo;меньше&raquo;,
вертикальная черта).</p>

<p>Проще всего создать новую папку библиотеки, выбрав в дереве в левой части окна
элемент &laquo;библиотеки&raquo; (или уже существующую папку, внутри которой
планируется создать новую), щелкнув на свободном месте панели списка блоков и
папок (возможно, еще пустой) правой кнопкой мыши и выбрав в контекстном меню пункт
&laquo;<span class="menu">создать | библиотеку</span>&raquo;
(<a href="#pic1_0" title="Создание папки библиотеки: выбор пункта меню (а) и созданная библиотека (а)">рис.&nbsp;257&nbsp;а</a>).
Если изменения в библиотеках заблокированы (кнопка с изображением замка нажата,
как на <a href="#pic1_0" title="Создание папки библиотеки: выбор пункта меню (а) и созданная библиотека (а)">рис.&nbsp;257&nbsp;а</a>),
RDS спросит, разрешить ли редактирование библиотек. Если разрешить
редактирование, в списке появится новая папка с именем
&laquo;<span class="file">Library<i>N</i></span>&raquo;, где <i>N</i> &ndash; число, подобранное так,
чтобы имя папки было уникальным (в данном случае, созданная библиотека будет
называться &laquo;<span class="file">Library1</span>&raquo;,
<a href="#pic1_1" title="Создание папки библиотеки: выбор пункта меню (а) и созданная библиотека (а)">рис.&nbsp;257&nbsp;б</a>).
При желании, можно сразу же дать ей другое имя, щелкнув на ней
правой кнопкой мыши, выбрав в контекстном меню пункт &laquo;<span class="menu">переименовать</span>&raquo;
и введя новое имя (имя должно быть уникальным в открытой папке). Теперь можно войти
внутрь нее двойным щелчком (в заголовке окна библиотеки отобразится имя открытой
папки).</p>

<div class="pic"><div class="container" id="pic1">
<div class="multi" id="pic1_0"><img src="../img/LibEdit_CreateLib1.png" width="586" height="274" alt="Создание папки библиотеки: выбор пункта меню (а) и созданная библиотека (а) 1" /><p id="light_pic1_0">(а)</p></div><div class="multi" id="pic1_1"><img src="../img/LibEdit_CreateLib2.png" width="443" height="274" alt="Создание папки библиотеки: выбор пункта меню (а) и созданная библиотека (а) 2" /><p id="light_pic1_1">(б)</p></div><p id="light_pic1">Рис.&nbsp;257.  Создание папки библиотеки: выбор пункта меню (а) и созданная библиотека (а)</p>
</div></div>




<p><span id="light_ref1">Добавим в эту библиотеку</span>
какой-либо блок &ndash;
<span id="ref2">например</span>, изображение манипулятора из схемы
&laquo;<span class="file"><span id="light_ref2">Hand.rds</span></span>&raquo;, создание
которого было описано в
<a href="um_2_10_12.htm" title="&sect;2.10.12. Пример создания блока с анимированной картинкой">&sect;2.10.12</a>. Для этого сначала следует загрузить
эту схему в RDS. Поскольку при загрузке схемы RDS восстанавливает состояние
открытых окон на момент ее сохранения, а при сохранении этой схемы окно библиотеки
не было открыто, окно с созданной папкой библиотеки закроется и изменения библиотек
снова заблокируются. Нужно снова открыть это окно (пункт меню
&laquo;<span class="menu">окна | окно библиотеки</span>&raquo;, разрешить изменения библиотек (отпустить
нажатую кнопку с замком на верхней панели) и выбрать в окне созданную библиотеку,
щелкнув на ее имени в элементе &laquo;библиотеки&raquo; дерева папок слева.
После этого следует разместить окно библиотеки и окно подсистемы с блоком
манипулятора рядом, чтобы было удобнее копировать блок.</p>

<p>Копировать блок из окна подсистемы в библиотеку можно двумя способами. Если оба
окна небольшие и их легко разместить рядом, можно перетащить блок в библиотеку: для
этого нужно нажать на его изображении в окне подсистемы <i>правую</i> кнопку мыши,
переместить курсор, не отпуская кнопку, на панель списка блоков окна библиотеки
(вместе с курсором будет перемещаться квадрат, символизирующий перетаскиваемый
блок) и отпустить кнопку. При этом важно перетащить блок именно правой кнопкой &ndash;
левой можно перетаскивать его только внутри окна подсистемы. Если же окна большие и
перекрывают друг друга, удобнее вставить блок в библиотеку через буфер обмена
(<a href="#pic2" title="Копирование блока в библиотеку через буфер обмена">рис.&nbsp;258</a>):
для этого нужно выделить его в окне подсистемы левой кнопкой, затем скопировать
его в буфер пунктом контекстного меню &laquo;<span class="menu">копировать</span>&raquo; или нажатием
<span class="keys">Ctrl</span>&nbsp;+&nbsp;<span class="keys">C</span>. После этого следует вытащить окно библиотеки на передний
план, например, щелкнув по нему левой кнопкой мыши (лучше щелкнуть по панели
списка блоков, чтобы случайно не попасть в какую-нибудь кнопку и не выбрать другую
библиотеку в дереве папок), и вставить блок из буфера пунктом контекстного меню
&laquo;<span class="menu">вставить</span>&raquo; или нажатием <span class="keys">Ctrl</span>&nbsp;+&nbsp;<span class="keys">V</span>.</p>

<div class="pic"><div class="container" id="pic2">
<img src="../img/LibEdit_CopyPasteBlock.png" width="732" height="381" alt="Копирование блока в библиотеку через буфер обмена" />
<p id="light_pic2">Рис.&nbsp;258. Копирование блока в библиотеку через буфер обмена</p>
</div></div>


<p>Новый блок в библиотеке получит то же имя, которое он имел в подсистеме (возможно,
к нему будет добавлена цифра для обеспечения уникальности), и у него не будет
ни всплывающей подсказки, ни иконки, вместо которой будет изображаться белый
квадрат. Добавленным блоком уже можно пользоваться, вытаскивая его из библиотеки в
подсистемы в разных схемах, но, чтобы пользователю было удобнее с ним работать,
желательно дать ему имя, отвечающее его назначению, всплывающую подсказку и
какую-нибудь иконку.</p>

<p><span id="ref3">Для</span>
изменения указанных параметров следует дважды щелкнуть на блоке в библиотеке
левой кнопкой мыши или выбрать пункт его контекстного меню
&laquo;<span class="menu">параметры</span>&raquo; &ndash; откроется
<span id="light_ref3">окно параметров библиотечного блока</span>,
изображенное
на <a href="#pic3" title="Окно параметров блока библиотеки">рис.&nbsp;259</a>.</p>

<div class="pic"><div class="container" id="pic3">
<img src="../img/LibEdit_BlockParams.png" width="431" height="444" alt="Окно параметров блока библиотеки" />
<p id="light_pic3">Рис.&nbsp;259. Окно параметров блока библиотеки</p>
</div></div>


<p><span id="ref4">В</span>
верхней части окна находится поле ввода для имени блока в библиотеке,
непосредственно под которым отображается полный путь к файлу с расширением
&laquo;<span class="file"><span id="light_ref4">.blk</span></span>&raquo;, в котором находится
сам блок (это полезно знать при редактировании библиотек средствами Windows вместо
окна библиотеки RDS). Имя блока в библиотеке всегда совпадает с именем файла,
в котором он хранится, поэтому на имя блока накладываются те же ограничения, что и на
имя файла в Windows: оно не должно содержать запрещенных символов (прямой и обратной
косой черты, двоеточия, вопросительного знака, звездочки, знака кавычки, знаков
&laquo;больше&raquo; и &laquo;меньше&raquo;, вертикальной черты). При изменении
имени в окне параметров блока файл блока автоматически переименовывается вместе со всеми
вспомогательными файлами, содержащими его иконки и всплывающую подсказку.</p>

<p>В средней части окна находятся две панели, на которых можно задать для блока
крупный (32&times;32 точки экрана) и мелкий (16&times;16 точек) значки. Обычно
достаточно задать только мелкий значок: во-первых, крупные значки используются только
в единственном <a href="um_2_16_1.htm#ref2" title="Стиль списка блоков">стиле списка блоков</a>
в библиотеке, а на панели блоков не используются вообще, и, во-вторых, при
отсутствии крупного значка RDS автоматически масштабирует мелкий. Если
предполагается, что пользователь будет работать с включенным стилем списка
&laquo;<span class="menu">крупные значки</span>&raquo;, крупный значок лучше задать, поскольку
масштабирование мелкого не всегда выглядит аккуратно. Если же работа в этом
стиле не предполагается, о крупном значке можно забыть, и задать только мелкий.</p>

<p><span id="ref5">Значок</span>
<span id="ref6">для</span>
блока можно либо загрузить из файла кнопкой &laquo;<span class="menu">загрузить</span>&raquo;
(поддерживаются форматы
&laquo;<span class="file"><span id="light_ref5">.bmp</span></span>&raquo; и
&laquo;<span class="file"><span id="light_ref6">.ico</span></span>&raquo;),
либо вставить из буфера обмена кнопкой &laquo;<span class="menu">вставить</span>&raquo;. Кнопка
&laquo;<span class="menu">очистить</span>&raquo; стирает значок &ndash; блок будет изображаться пустым
квадратом. Если в качестве значка используется растровый рисунок в формате BMP,
цвет его левого нижнего угла всегда считается прозрачным &ndash; при рисовании списка
блоков этот цвет будет заменен на цвет панели списка. В RDS нет встроенного
редактора растровых рисунков, поэтому для задания значка следует использовать любой
внешний редактор &ndash; например, стандартный для Windows редактор
&laquo;Paint&raquo;.</p>

<p>Ниже вводится текст всплывающей подсказки, которая
будет появляться на экране, если пользователь задержит курсор над этим блоком в
списке. Подсказка может состоять из нескольких строк, обычно в ней указывают
название и назначение блока.</p>

<p><span id="ref7">В</span>
<span id="ref8">самом</span>
<span id="ref9">низу</span>
окна располагается панель &laquo;<span class="menu"><span id="light_ref9">справка по блоку</span></span>&raquo;
с двумя полями ввода:
&laquo;<span class="menu">файл</span>&raquo; и &laquo;<span class="menu">тема</span>&raquo;. На этой панели можно указать файл справки,
который будет вызываться для данного блока, если выделить его в окне библиотеки или нажать его
кнопку на панели блоков, а затем нажать клавишу <span class="keys">F1</span>).
Имя вводится вручную или выбирается в стандартном диалоге открытия файла, который вызывается кнопкой
&laquo;<span class="menu">&hellip;</span>&raquo;. Путь к файлу запоминается относительно
<a href="um_2_18.htm#light_ref13" title="Папка документации">стандартной папки документации</a>
RDS. Если в качестве файла справки используется файл формата <span id="light_ref7">html</span>
или специальный файл справки RDS формата
&laquo;<span class="file"><span id="light_ref8">.ui</span></span>&raquo;, можно также указать имя темы
внутри этого файла. Поддерживаются следующие стандартные форматы файлов:</p>

<ul>
  <li>Hypertext Markup Language (HTML, расширения файлов &laquo;<span class="file">.html</span>&raquo;,
  &laquo;<span class="file">.htm</span>&raquo;). Для этого формата можно в качестве имени темы указать
  &laquo;якорь&raquo; (anchor) внутри файла.</li>

  <li><span id="light_ref10">Portable Document Format</span>
  (расширения файлов &laquo;<span class="file">.pdf</span>&raquo;).</li>

  <li>Обычный текстовый файл (расширения файлов
  &laquo;<span class="file"><span id="light_ref11">.txt</span></span>&raquo;).</li>

  <li><span id="light_ref12">OpenDocument Text</span>
  (расширения файлов &laquo;<span class="file">.odt</span>&raquo;).</li>

  <li><span id="ref13">Файлы</span>
  <span id="ref14">справки</span> Windows
  (расширения файлов &laquo;<span class="file"><span id="light_ref14">.hlp</span></span>&raquo;,
  &laquo;<span class="file"><span id="light_ref13">.chm</span></span>&raquo;).</li>

  <li><span id="light_ref15">Portable Network Graphics</span>
  (расширения файлов &laquo;<span class="file">.png</span>&raquo;).</li>
</ul>

<p class="noindent"><span id="ref16">Кроме</span>
указанных форматов, в качестве файла справки можно использовать специальный
файл справки RDS формата &laquo;<span class="file">.ui</span>&raquo;, представляющий собой набор ссылок на
файлы стандартных форматов. Этот файл похож на ini-файлы Windows и
<span id="light_ref16">имеет следующую структуру</span>:</p>

<pre class="cpp">  [Main]
  File=<i>имя_файла_главной_справки</i>
  Menu=<i>имя_в_меню_справки_RDS</i>
  Anchors=<i>наличие_тем_в_файлах_1_или_0</i>
  [Topics]
  <i>имя_темы_1</i>=<i>имя_файла_1</i>|<i>якорь_в_файле_1</i>
  <i>имя_темы_2</i>=<i>имя_файла_2</i>
  &hellip;</pre>

<p class="noindent">Файл состоит из двух секций: &laquo;<span class="cpp">[Main]</span>&raquo; и
&laquo;<span class="cpp">[Topics]</span>&raquo;. В секции &laquo;<span class="cpp">[Main]</span>&raquo; записываются параметры всего
файла справки:</p>

<ul>
  <li>Параметры &laquo;<span class="cpp">File</span>&raquo; и &laquo;<span class="cpp">Menu</span>&raquo; &ndash; имя главного файла справки
  и пункт меню для него соответственно. Путь к главному файлу справки считается заданным относительно
  папки файла &laquo;<span class="file">.ui</span>&raquo;. Эти параметры используются для добавления новых пунктов в
  подменю справки &laquo;<span class="menu">?</span>&raquo;
  <a href="um_2_1.htm" title="&sect;2.1. Главное окно и главное меню">главного меню RDS</a>. При запуске RDS просматривает
  стандартную папку документации и ее вложенные папки, находит там все файлы с расширением
  &laquo;<span class="file">.ui</span>&raquo;, считывает из каждого секцию &laquo;<span class="cpp">[Main]</span>&raquo; и добавляет в
  подменю справки пункты, соответствующие указанным там файлам. Например, для главной справки
  RDS в файле &laquo;<span class="file">RdsHelp.ui</span>&raquo;, находящемся в подпапке
  &laquo;<span class="file">RDSHelp</span>&raquo; внутри папки документации, указан главный файл
  &laquo;<span class="file">index.htm</span>&raquo; и пункт меню &laquo;<span class="menu">Описания RDS</span>&raquo;. Это значит, что в подменю
  &laquo;<span class="menu">?</span>&raquo; будет присутствовать пункт с указанным именем, при выборе которого
  откроется файл &laquo;<span class="file">RDSHelp\RdsHelp.ui</span>&raquo; из папки документации. В файлах
  &laquo;<span class="file">.ui</span>&raquo; справок блоков эти параметры можно не указывать.</li>

  <li>Параметр &laquo;<span class="cpp">Anchors</span>&raquo; указывает на наличие или отсутствие имен тем
  (&laquo;якорей&raquo;) в именах справочных файлов, указанных ниже в секции
  &laquo;<span class="cpp">[Topics]</span>&raquo;. Чтобы в именах файлов после знака &laquo;|&raquo; (вертикальная черта)
  можно было указывать имя темы в этом файле (на данный момент поддерживается только для файлов html),
  необходимо записать &laquo;<span class="cpp">Anchors=1</span>&raquo;. При &laquo;<span class="cpp">Anchors=0</span>&raquo; имена
  тем использовать нельзя.</li>
</ul>

<p class="noindent">В секции &laquo;<span class="cpp">[Topics]</span>&raquo; в каждой строке записывается имя темы
справки (так, как оно будет указано в
<a href="#pic3" title="Окно параметров блока библиотеки">окне параметров</a> блока библиотеки), после которого
ставится знак равенства, за которым следует либо имя файла справки для этой темы
(путь указывается относительно папки файла &laquo;<span class="file">.ui</span>&raquo;), либо имя файла справки,
знак вертикальной черты (&laquo;|&raquo;), и имя темы &ndash; &laquo;якоря&raquo; html
в этом файле (пробелы до и после вертикальной черты недопустимы). Используя
&laquo;якоря&raquo;, можно разместить справки к нескольким блокам
в одном файле html.</p>

<p>В рассматриваемом здесь примере справка к добавленному в библиотеку блоку создаваться не будет.</p>

<p>Изменим параметры добавленного в библиотеку блока-манипулятора так, чтобы
пользователю было легко узнать его среди других блоков. Заменим в окне его
параметров малоинформативное имя &laquo;<span class="rdsvar">Block1</span>&raquo; на более понятное
&laquo;<span class="rdsvar">Hand</span>&raquo; &ndash; теперь при вставке этого блока в подсистему он
будет последовательно получать имена &laquo;<span class="rdsvar">Hand1</span>&raquo;,
&laquo;<span class="rdsvar">Hand2</span>&raquo; и т.д. Зададим для него мелкий значок (его придется
нарисовать отдельно в каком-либо редакторе растровых рисунков) и введем текст
всплывающей подсказки
(<a href="#pic4" title="Измененные параметры блока">рис.&nbsp;260</a>).</p>

<div class="pic"><div class="container" id="pic4">
<img src="../img/LibEdit_BlockParams1.png" width="431" height="444" alt="Измененные параметры блока" />
<p id="light_pic4">Рис.&nbsp;260. Измененные параметры блока</p>
</div></div>


<p>Закроем окно кнопкой &laquo;<span class="menu">OK</span>&raquo;. Теперь в окне библиотеки у блока
появился значок
(<a href="#pic5" title="Блок с измененными параметрами в библиотеке">рис.&nbsp;261</a>),
а при наведении на него курсора мыши появляется всплывающая подсказка.</p>

<div class="pic"><div class="container" id="pic5">
<img src="../img/LibEdit_PopupHint.png" width="382" height="279" alt="Блок с измененными параметрами в библиотеке" />
<p id="light_pic5">Рис.&nbsp;261. Блок с измененными параметрами в библиотеке</p>
</div></div>


<p>Если какой-либо блок уже сохранен в файл, его можно вставить в нужную папку
библиотеки, выбрав в главном меню RDS пункт
&laquo;<span class="menu">редактирование | создать | копировать блок из файла</span>&raquo; (этот же пункт есть
и в контекстном меню панели списка блоков). Блок будет скопирован в библиотеку без
значков и всплывающей подсказки, их придется задавать описанным выше образом.</p>

<p>Копирование блоков из библиотеки в библиотеку производится так же, как и вставка их
из подсистем: блоки либо перетаскиваются правой клавишей (при этом RDS спрашивает,
нужно переместить блок или скопировать его), либо копируются в буфер обмена в одной
библиотеке и вставляются из него в другую.</p>
<p>Параметры можно задавать не только для блоков в библиотеках, но и для самих папок
библиотек (поскольку двойной щелчок на папке открывает ее, окно параметров для
библиотеки можно вызвать только через контекстное меню или через пункт
&laquo;<span class="menu">редактирование | параметры</span>&raquo; главного меню RDS). Папка библиотеки
тоже может иметь собственный нестандартный значок и всплывающую подсказку, в которой,
как правило, поясняется общее назначение блоков в этой папке.</p>

<p><span id="ref17">Иногда</span>
возникает необходимость <span id="light_ref17">заменить</span> уже имеющийся в
библиотеке блок на его новую или измененную версию. В RDS для этого предусмотрена
специальная функция, позволяющая заменить блок в библиотеке на блок, содержащийся
в буфере обмена. Для этого следует:</p>

<ol>
  <li>Поместить новую версию блока в какую-либо подсистему схемы (или вставить туда
  библиотечный блок и внести необходимые изменения в его параметры).</li>
  <li>Скопировать этот блок в буфер обмена.</li>
  <li>Открыть окно библиотеки и выбрать в нем папку, в которой находится блок,
  который нужно заменить.</li>
  <li>Выделить этот блок и выбрать в его контекстном меню пункт
  &laquo;<span class="menu">заменить блок</span>&raquo;.</li>
</ol>

<p class="noindent">После подтверждения замены библиотечный блок будет заменен
на содержимое буфера обмена, а его имя, значки и всплывающая подсказка останутся
прежними.</p>

<p>Следует помнить, что подсистемы в RDS тоже являются блоками и, поэтому,
тоже могут быть добавлены в библиотеки, как и любые другие блоки.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="um_2_16_1.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="um_2_16_3.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_16_2">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
