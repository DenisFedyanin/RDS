<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>&sect;2.19.1. Подключение модулей автоматической компиляции моделей блоков</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="um_index.htm">Описание пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2">Глава 2. Интерфейс пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2_19">&sect;2.19. Подключение дополнительных модулей</a></p>
<div class="level"><p>&sect;2.19.1. Подключение модулей автоматической компиляции моделей блоков</p>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="um_2_18.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="um_2_19_2.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_19_1">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Описание пользователя</h1>
<h2 class="off">Глава 2. Интерфейс пользователя</h2>
<h3>&sect;2.19. Подключение дополнительных модулей</h3>
<p class="abstract">Описывается подключение к RDS дополнительных программных модулей.</p>
<h4>&sect;2.19.1. Подключение модулей автоматической компиляции моделей блоков</h4>
<p class="abstract">Описывается подключение к RDS внешних модулей, автоматизирующих сборку моделей блоков из фрагментов исходного текста, введенных пользователем.</p>


<p>Модули <a href="um_1_8.htm" title="&sect;1.8. Автоматическая компиляция моделей блоков">автоматической компиляции</a>
позволяют собирать из отдельных фрагментов программы, введенной пользователем,
полноценную работающую <a href="um_1_2.htm#ref3" title="Модель блока">модель блока</a>. Как правило,
для этого используется внешний компилятор какого-либо языка высокого уровня:
модуль формирует из введенных пользователем фрагментов полный исходный текст программы
модели блока, вызывает компилятор для преобразования этого текста в динамически
подключаемую библиотеку (DLL) Windows, а затем дает RDS указание подключить
модель из этой библиотеки к блокам, которые этот модуль обслуживает. Модули
автокомпиляции несколько облегчают жизнь тем пользователям, которым необходимо
создавать собственные модели блоков: во многих случаях пользователю гораздо проще
ввести несколько операторов, задающих реакцию блока на те или иные события,
чем самостоятельно писать полный текст программы модели со всеми определениями и
вспомогательными вызовами, необходимыми для подключения этой программы к RDS.</p>

<p>Модули автокомпиляции не встроены в главную программу RDS: как и модели блоков,
они представляют собой специальным образом написанные функции,
размещающиеся во внешних динамических библиотеках.
<span id="ref1">В</span>
 состав RDS входит несколько
модулей, расположенных в библиотеке
&laquo;<span class="file"><span id="light_ref1">Common.dll</span></span>&raquo; и
предназначенных для работы с компиляторами языка C++ (они подробно описаны в
<a href="um_index.htm#light_htm:um_3" title="Глава 3. Использование стандартных модулей автокомпиляции">главе 3</a>). Сами компиляторы для этих модулей в
состав RDS, естественно, не входят, их необходимо устанавливать отдельно,
а затем указывать в настройках модулей папки их установки. На данный момент
модулями поддерживается шесть компиляторов (как бесплатных, так и коммерческих
&ndash; подробнее в <a href="um_1_8.htm" title="&sect;1.8. Автоматическая компиляция моделей блоков">&sect;1.8</a>), но, при необходимости,
модуль, предназначенный для работы с одним компилятором, достаточно просто
перенастроить на работу с другим. Сторонние разработчики могут, при желании,
создать свои собственные модули автокомпиляции и для других языков высокого уровня
&ndash; правила создания таких модулей подробно рассмотрены в
<a href="pm_index.htm#light_htm:pm_4" title="Глава 4. Создание модулей автоматической компиляции">главе 4 руководства программиста</a>. К RDS можно подключить
любой модуль, соответствующий этим правилам.</p>

<p>Для того, чтобы модуль автокомпиляции можно было подключить к блоку, модель
которого модуль будет обслуживать, этот модуль должен быть
зарегистрирован в RDS. Только тогда он появится в выпадающем списке модулей на
<a href="um_2_9_1.htm#pic12" title="Вкладка компиляция окна параметров блока (модель не подключена)">вкладке &laquo;<span class="menu">компиляция</span>&raquo;</a>
окна параметров блока. Для регистрации нового модуля, удаления старого, настройки
параметров уже зарегистрированного, а также перемещения модуля вверх или вниз в
списке служит окно подключения модулей автокомпиляции
(<a href="#pic1" title="Окно подключения модулей автокомпиляции">рис.&nbsp;285</a>),
вызываемое пунктом <a href="um_2_1.htm" title="&sect;2.1. Главное окно и главное меню">главного меню</a>
&laquo;<span class="menu">сервис | автокомпиляция</span>&raquo;.</p>

<div class="pic"><div class="container" id="pic1">
<img src="../img/AutocompModules.png" width="533" height="370" alt="Окно подключения модулей автокомпиляции" />
<p id="light_pic1">Рис.&nbsp;285. Окно подключения модулей автокомпиляции</p>
</div></div>


<p>Верхнюю часть окна занимает список зарегистрированных модулей, в котором они
перечисляются в том же порядке, что и в выпадающем списке для подключении модуля к
блоку (обычно чаще всего используемые модули помещают в начало списка). В нижней
части располагаются три поля ввода для параметров текущего выбранного в списке
модуля &ndash; при выборе модуля в списке в этих полях появляются его параметры,
а при изменении значений в полях новые параметры немедленно заносятся в список.
Сами действия по регистрации новых модулей, удалению старых или запоминанию изменившихся
параметров в общих настройках RDS будут выполнены только при нажатии кнопки
&laquo;<span class="menu">OK</span>&raquo;, поэтому, если какие-либо параметры изменены по ошибке, можно
нажать кнопку &laquo;<span class="menu">отмена</span>&raquo;, и тогда сделанные изменения будут отменены.</p>

<p>Каждый модуль автокомпиляции имеет три основных параметра: имя файла библиотеки,
в которой находится его функция, имя самой функции и название, под которым этот
модуль видит пользователь. Эти параметры и вводятся в полях в нижней части окна:</p>

<ul>
  <li>В поле &laquo;<span class="menu">библиотека</span>&raquo; вводится вручную или выбирается из
  выпадающего списка имя файла динамически подключаемой библиотеки (DLL), в которой
  находится функция модуля автокомпиляции. В выпадающем списке перечислены только файлы
  библиотек, находящиеся в
  <a href="um_2_18.htm#light_ref11" title="Папка стандартных DLL">стандартной папке DLL</a> RDS, вручную же можно ввести
  путь к файлу, расположенному в любой папке. Можно также выбрать этот файл в
  стандартном диалоге Windows, нажав кнопку &laquo;<span class="menu">обзор</span>&raquo;. Пути к стандартным
  папкам RDS, как и при подключении моделей к блокам, автоматически заменяются
  на их <a href="rdsGetFullFilePath.htm#ref1" title="Символические обозначения стандартных путей">символические обозначения</a>.
  На <a href="#pic1" title="Окно подключения модулей автокомпиляции">рис.&nbsp;285</a> выбранный модуль
  автокомпиляции расположен в библиотеке &laquo;<span class="file">Common.dll</span>&raquo; в
  стандартной папке DLL RDS.</li>

  <li>В поле &laquo;<span class="menu">функция</span>&raquo; вводится имя экспортированной функции модуля.
  <span id="ref2">Если</span>
  вместе с библиотекой, указанной в поле &laquo;<span class="menu">библиотека</span>&raquo;, поставляется
  специальный <span id="light_ref2">файл описаний с расширением
  &laquo;<span class="file">.inf</span>&raquo;</span>, имя функции можно выбрать
  из выпадающего списка, причем после нее в скобках автоматически появится название
  модуля, данное ему программистом. В этом же поле можно ввести дополнительный параметр
  модуля (см. ниже). На <a href="#pic1" title="Окно подключения модулей автокомпиляции">рис.&nbsp;285</a> выбранный
  модуль обслуживается функцией с именем &laquo;BCpp55&raquo;.</li>

  <li>В поле &laquo;<span class="menu">название</span>&raquo; вводится строка названия модуля, которое
  будет отображаться в списке. В отличие от двух предыдущих, это поле никак не
  влияет на работу модуля, поэтому пользователь может изменять название так, как
  ему угодно. На <a href="#pic1" title="Окно подключения модулей автокомпиляции">рис.&nbsp;285</a> выбранный
  модуль называется &laquo;Borland С++ 5.5&raquo;.</li>
</ul>

<p>Для того, чтобы зарегистрировать модуль автокомпиляции в RDS, необходимо
знать имя файла его библиотеки и имя его функции &ndash; обычно эта информация
предоставляется разработчиком модуля. За прочие настройки этого модуля, в том
числе, и за указание размещения используемого внешнего компилятора, отвечает сам
модуль: у него должно быть собственное окно настройки.</p>

<p><span id="ref3">Все</span>
действия с модулями, включая вызов их настроек, выполняются при помощи кнопок
справа от их списка:</p>

<div class="tablecenter"><div class="tcont">
<table>
  <tr>
    <th>Кнопка</th>
    <th>Действие</th>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Plus.png" width="25" height="25" alt="Кнопка: плюс" /></td>
    <td>Добавить новый модуль.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_properties.png" width="25" height="25" alt="Кнопка: свойства" /></td>
    <td>Вызвать <span id="light_ref3">настройку</span> выбранного в списке модуля (вместо нажатия этой кнопки
    можно просто дважды щелкнуть по названию модуля в списке).</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_ArrowUp.png" width="25" height="25" alt="Кнопка: вверх" /></td>
    <td>Переместить выбранный модуль на одну позицию вверх по списку.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_ArrowDown.png" width="25" height="25" alt="Кнопка: вниз" /></td>
    <td>Переместить выбранный модуль на одну позицию вниз по списку.</td>
  </tr>
  <tr>
    <td class="center"><img class="btn" src="../img/Button_Delete.png" width="25" height="25" alt="Кнопка: удалить" /></td>
    <td>Удалить выбранный модуль из списка.</td>
  </tr>
</table>
</div></div>

<p>Удаление модуля из списка не вызывает удаление с диска файла библиотеки, в
которой находится его функция &ndash; RDS просто забывает о его существовании.</p>

<p>Поскольку, как правило, один и тот же модуль можно использовать для работы с
целым семейством компиляторов, RDS позволяет указать имя набора параметров,
используемого для настройки модуля. Необходимость использовать его возникает достаточно
редко (чаще всего для работы достаточно одного единственного компилятора, и, если
он установлен и настроен, другой подключать к RDS незачем), поэтому отдельного
поля ввода для него не предусмотрено &ndash; он указывается в поле
&laquo;<span class="menu">функция</span>&raquo; после имени функции модуля через знак дроби
&laquo;/&raquo;.</p>

<p>Допустим, например, что в RDS зарегистрирован и успешно работает стандартный
модуль автокомпиляции, использующий бесплатный компилятор
<a href="um_3_2_1.htm" title="&sect;3.2.1. Установка и подключение компилятора Borland C++ 5.5">Borland C++ 5.5</a>. Этот
модуль представляет собой функцию с именем &laquo;<span class="menu">BCpp55</span>&raquo;, экспортированную
из файла &laquo;<span class="file">Common.dll</span>&raquo;, находящегося в стандартной папке DLL RDS.
Пользователь по каким-то причинам хочет использовать, кроме указанного, еще один
компилятор, но модуля, предназначенного для работы с ним, в составе RDS нет.
Выйти из этого положения он может, например, изменив параметры модуля для
Borland С++ 5.5: указав в нем другую папку с компилятором, другие параметры
командной строки для вызова самого компилятора и редактора связей и т.п. Но если
добавить в список еще один модуль и тоже связать его с функцией &laquo;BCpp55&raquo;
из библиотеки &laquo;<span class="file">Common.dll</span>&raquo;, у него окажутся общие параметры с
уже зарегистрированным в системе модулем и, при изменении параметров нового модуля,
параметры старого тоже изменятся, что нежелательно. Чтобы этого не случилось, в
новом модуле можно указать тот же файл библиотеки и ту же функцию в ней, но после
функции через дробь записать имя набора параметров, которое не должно содержать символов,
запрещенных для имен файлов (прямая и обратная косая черта, двоеточие, вопросительный
знак, звездочка, знак кавычки, знаки &laquo;больше&raquo; и &laquo;меньше&raquo;,
вертикальная черта) и пробела. В данном случае, можно дать набору параметров имя
&laquo;new&raquo; и ввести в поле &laquo;<span class="menu">функция</span>&raquo; текст
&laquo;BCpp55/new&raquo;. RDS автоматически отделит имя функции, то есть
слово до дроби (&laquo;BCpp55&raquo;) от имени набора параметров, то есть слова
после дроби (&laquo;new&raquo;) &ndash; функция с указанным именем будет
загружена из библиотеки и ей будет передано имя набора параметров. Как функция будет
использовать это имя, решает ее программист, RDS просто передает его ей.
<span id="ref4">Все</span> стандартные модули автокомпиляции из библиотеки &laquo;<span class="file">Common.dll</span>&raquo;
хранят свои настройки в файлах с расширением
&laquo;<span class="file"><span id="light_ref4">.ac</span></span>&raquo; внутри папки
&laquo;<span class="file">Common</span>&raquo; внутри
<a href="um_2_18.htm#ref2" title="Папка настроек">папки настроек RDS</a>, а имя файла состоит из
имени функции и имени набора параметров. В описанном выше случае параметры исходного
модуля автокомпиляции будут записываться в файл
&laquo;<span class="file">Common\BCpp55.ac</span>&raquo;, а параметры нового модуля – в файл
&laquo;<span class="file">CommonBCpp55.new.ac</span>&raquo;.</p>

<p><span id="ref5">Сам</span> список зарегистрированных модулей хранится в
файле &laquo;<span class="file"><span id="light_ref5">autocomp.dat</span></span>&raquo; в
папке настроек RDS.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="um_2_18.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="um_2_19_2.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_19_1">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
