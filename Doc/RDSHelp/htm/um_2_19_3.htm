<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
<head>
  <link rel="stylesheet" type="text/css" href="../css/main.css" />
  <link rel="stylesheet" type="text/css" href="../css/cpp.css" />
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1251" />
  <script type="text/javascript" src="script.js"></script>
  <title>&sect;2.19.3. Подключение модулей расширения</title>
</head><body onload="DocLoad()">
<div class="pageheader"><span class="off"><b>Текущий раздел:</b></span>
<div class="int"><p id="top"><a href="../index.htm">Описания RDS</a></p>
<div class="level"><p><a href="um_index.htm">Описание пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2">Глава 2. Интерфейс пользователя</a></p>
<div class="level"><p><a href="um_index.htm#light_htm:um_2_19">&sect;2.19. Подключение дополнительных модулей</a></p>
<div class="level"><p>&sect;2.19.3. Подключение модулей расширения</p>
</div>
</div>
</div>
</div>
</div></div>
<div class="topnav"><span class="off"><b>Навигация:</b></span>
<div class="left">
<span class="button"><a href="um_2_19_2.htm" title="Предыдущий параграф" id="pgup">&lt;&lt;</a></span>
<span class="button"><a href="um_2_20.htm" title="Следующий параграф" id="pgdn">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_19_3">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>

<div class="text">
<h1 class="off">Описание пользователя</h1>
<h2 class="off">Глава 2. Интерфейс пользователя</h2>
<h3 class="off">&sect;2.19. Подключение дополнительных модулей</h3>
<h4>&sect;2.19.3. Подключение модулей расширения</h4>
<p class="abstract">Описывается подключение к RDS программных модулей расширения, выполняющих различные действия над загруженной схемой по команде пользователя или модели одного из блоков.</p>


<p><span class="term">Модули расширения</span> &ndash; это дополнительные функции
из внешних библиотек, которые могут вызываться как пользователем из
<a href="um_2_1.htm" title="&sect;2.1. Главное окно и главное меню">главного меню RDS</a>, так и моделями блоков по
имени выполняемой модулем операции. Как правило, они используются для выполнения действий,
не связанных с каким-либо блоком схемы &ndash; в отличие от модели блока, функцию
модуля расширения можно вызвать даже тогда, когда никакая схема не загружена в память
RDS. Вызванный модуль расширения может, например, автоматически загрузить какую-либо
схему, внести в нее изменения и сохранить ее. Модуль, вызванный пользователем через меню,
может, при необходимости, остаться в памяти и продолжать выполнять какие-либо действия
по таймеру или реагируя на системные события до тех пор, пока не будет загружена новая
схема. Загрузка пользователем новой схемы прекращает работу всех находящихся в памяти
модулей расширения, это гарантирует отсутствие неожиданных для пользователя последствий
их работы &ndash; в противном случае поведение схемы зависело бы от того, что
пользователь делал перед ее загрузкой, что нежелательно.</p>

<p>Как и
<a href="um_2_19_1.htm" title="&sect;2.19.1. Подключение модулей автоматической компиляции моделей блоков">модули автокомпиляции</a>
и <a href="um_2_19_2.htm" title="&sect;2.19.2. Подключение модулей преобразования BMP">преобразования BMP</a>, модули расширения
необходимо регистрировать в RDS. Для этого служит окно подключения модулей,
вызываемое пунктом главного меню &laquo;<span class="menu">сервис | расширения</span>&raquo;
(<a href="#pic1" title="Окно подключения модулей расширения">рис.&nbsp;289</a>).</p>

<div class="pic"><div class="container" id="pic1">
<img src="../img/Tools.png" width="533" height="402" alt="Окно подключения модулей расширения" />
<p id="light_pic1">Рис.&nbsp;289. Окно подключения модулей расширения</p>
</div></div>


<p>Окно имеет стандартную структуру (окна регистрации всех модулей похожи): список модулей
с кнопками управления находится в верхней части, поля ввода параметров выбранного в
списке модуля &ndash; в нижней. Изменения, сделанные в окне подключения модулей,
записываются в общие настройки RDS только после нажатия кнопки
&laquo;<span class="menu">OK</span>&raquo;.
<span id="ref1">Список</span> зарегистрированных модулей хранится в
файле &laquo;<span class="file"><span id="light_ref1">tools.dat</span></span>&raquo; в
<a href="um_2_18.htm#ref2" title="Папка настроек">папке настроек RDS</a>. В нижней части окна для модуля
задаются следующие параметры:</p>

<ul>
  <li>В поле &laquo;<span class="menu">библиотека</span>&raquo; указывается имя библиотеки (DLL) с функцией
  модуля. Имя файла библиотеки либо вводится вручную, либо выбирается из выпадающего
  списка с файлами <a href="um_2_18.htm#light_ref11" title="Папка стандартных DLL">стандартной папки DLL</a> RDS, либо
  задается в диалоге выбора файла Windows при нажатии кнопки &laquo;<span class="menu">обзор</span>&raquo;.
  На <a href="#pic1" title="Окно подключения модулей расширения">рис.&nbsp;289</a> выбранный модуль расширения расположен
  в библиотеке &laquo;<span class="file">Test.dll</span>&raquo; в стандартной папке DLL RDS.</li>

  <li>В поле &laquo;<span class="menu">функция</span>&raquo; вводится имя экспортированной из библиотеки
  функции модуля. На <a href="#pic1" title="Окно подключения модулей расширения">рис.&nbsp;289</a> эта функция называется
  &laquo;TestTool&raquo;.</li>

  <li>В поле &laquo;<span class="menu">пункт меню</span>&raquo; вводится текст, который будет служить именем
  пункта меню для данного модуля. Пункты модулей расширения размещаются в конце меню
  &laquo;<span class="menu">сервис</span>&raquo; <a href="um_2_1.htm" title="&sect;2.1. Главное окно и главное меню">главного меню RDS</a> в
  том порядке, в котором модули указаны в списке. В этом меню можно создавать подменю
  любой вложенности, разделяя их имена знаками дроби (&laquo;/&raquo;), обратной косой
  черты (&laquo;\&raquo;) или вертикальной черты (&laquo;|&raquo;) На
  <a href="#pic1" title="Окно подключения модулей расширения">рис.&nbsp;289</a> для выбранного модуля введен текст
  &laquo;Подменю | Тестовый модуль расширения&raquo;, что означает, что в меню
  &laquo;<span class="menu">сервис</span>&raquo; будет создан пункт с названием &laquo;<span class="menu">подменю</span>&raquo;, в
  котором будет находиться подпункт &laquo;<span class="menu">тестовый модуль расширения</span>&raquo;
  (<a href="#pic2" title="Меню вызова модуля расширения">рис.&nbsp;290</a>).</li>
</ul>

<div class="pic"><div class="container" id="pic2">
<img src="../img/ToolsMenu.png" width="775" height="168" alt="Меню вызова модуля расширения" />
<p id="light_pic2">Рис.&nbsp;290. Меню вызова модуля расширения</p>
</div></div>


<ul>
  <li>В поле &laquo;<span class="menu">внутр.&nbsp;имя</span>&raquo; указывается условное название выполняемой
  модулем расширения операции, по которой его смогут вызывать модели блоков и другие
  модули расширения. Это название никак не связано ни с файлом библиотеки, ни с
  именем экспортированной из нее функции модуля. Если какая-либо модель или какой-либо
  другой модуль используют в своей работе некоторый модуль расширения, в документации к
  ним должно быть указано название функции, которую они вызывают. Зная это название,
  можно ввести его в поле &laquo;<span class="menu">внутр.&nbsp;имя</span>&raquo; для желаемого модуля
  &ndash; одну и ту же операцию могут по-разному выполнять различные модули, и
  пользователь может таким образом указать тот, который ему нужен.</li>
</ul>

<p class="noindent">В состав RDS не входит ни одного стандартного модуля расширения, они могут
быть созданы сторонними разработчиками для своих целей.</p>

</div>
<p style="clear:both; min-height:1em; padding:0px; margin: 0px;"></p><hr class="off" /><div class="bottomnav">
<div class="left">
<span class="button"><a href="um_2_19_2.htm" title="Предыдущий параграф" id="pgup_f">&lt;&lt;</a></span>
<span class="button"><a href="um_2_20.htm" title="Следующий параграф" id="pgdn_f">&gt;&gt;</a></span>
<span class="divider"></span>
<span class="button"><a href="um_index.htm#light_htm:um_2_19_3">Оглавление</a></span>
<span class="button"><a href="alpha.htm">Указатель</a></span>
</div>
</div>
</body>
</html>
